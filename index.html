<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>上海大学宝山校区路径计算</title>
    <script type="text/javascript" src="https://api.map.baidu.com/api?v=3.0&ak=wE7L9NflFWyPXutp6zeW1gw1o2BRTdxX"></script>
    <style>
        /* 设置地图容器的大小 */
        #map {
            width: 100%;
            height: 600px;
            margin-top: 20px;
        }

        /* 调整控件的样式 */
        label, select, button {
            font-size: 18px;  /* 增加字体大小 */
        }

        select, button {
            padding: 10px;  /* 增加内边距 */
            margin: 10px;   /* 增加控件之间的间距 */
            border-radius: 5px;  /* 调整按钮和下拉框的圆角 */
        }

        select {
            width: 250px;  /* 增加下拉框宽度 */
        }

        button {
            width: 150px;  /* 增加按钮宽度 */
        }
    </style>
</head>
<body>
    <h1>上海大学宝山校区路径计算</h1>
    <!-- 地图容器 -->
    <div id="map"></div>

    <!-- 起点与终点选择框 -->
    <label for="startPoint">选择起点:</label>
    <select id="startPoint"></select>

    <label for="endPoint">选择终点:</label>
    <select id="endPoint"></select>

    <!-- 计算路径按钮 -->
    <button onclick="calculateRoute()">计算路径</button>

    <!-- 引入JavaScript -->
    <script type="text/javascript">
        // 确保地图初始化
        var map = new BMap.Map("map");  // 初始化地图
        var point = new BMap.Point(121.4692, 31.2439);  // 设置中心点为上海大学宝山校区
        map.centerAndZoom(point, 15);  // 设置缩放级别
        map.enableScrollWheelZoom(true);  // 启用滚轮缩放

        // 打印地图初始化情况
        console.log('地图初始化成功');

        // 定义50个校园点的经纬度
        var campusPoints = [
            {name: "校区入口", coords: {lat: 31.2439, lng: 121.4692}},
            {name: "教学楼A", coords: {lat: 31.2440, lng: 121.4680}},
            {name: "教学楼B", coords: {lat: 31.2442, lng: 121.4675}},
            // 添加更多点...
        ];

        // 在地图上添加校园点并更新下拉菜单
        function addCampusPoints() {
            var startSelect = document.getElementById("startPoint");
            var endSelect = document.getElementById("endPoint");

            campusPoints.forEach(function(point, index) {
                var marker = new BMapGL.Marker(new BMapGL.Point(point.coords.lng, point.coords.lat));
                map.addOverlay(marker);  // 在地图上添加标记

                // 将点添加到起点和终点下拉菜单中
                var optionStart = document.createElement("option");
                optionStart.text = point.name;
                optionStart.value = index;
                startSelect.add(optionStart);

                var optionEnd = document.createElement("option");
                optionEnd.text = point.name;
                optionEnd.value = index;
                endSelect.add(optionEnd);
            });
        }

        // 调用函数，在地图上添加校园点
        addCampusPoints();

        // 计算路径的函数
        function calculateRoute() {
            var startIndex = document.getElementById("startPoint").value;
            var endIndex = document.getElementById("endPoint").value;

            var startPoint = new BMap.Point(campusPoints[startIndex].coords.lng, campusPoints[startIndex].coords.lat);
            var endPoint = new BMap.Point(campusPoints[endIndex].coords.lng, campusPoints[endIndex].coords.lat);

            var driving = new BMap.DrivingRoute(map, {
                renderOptions: { map: map, autoViewport: true }
            });

            // 调用百度地图的DrivingRoute接口，计算起点到终点的行车路径
            driving.search(startPoint, endPoint);
        }
    </script>
</body>
</html>
